{"version":3,"sources":["src/html-imports.js"],"names":["scope","Loader","onLoad","onComplete","cache","onload","oncomplete","inflight","pending","fixUrlsInTemplates","element","base","t$","querySelectorAll","i","length","content","template","n$","n","localName","path","resolveUrlsInStyle","l","attrs","a","at","v","attributes","value","search","resolveUrlsInCssText","replaceAttrUrl","getLoadingDonePromise","Promise","resolve","addEventListener","whenReady","callback","doc","rootDocument","whenDocumentReady","watchImportsLoad","readyState","requiredReadyState","checkReady","removeEventListener","READY_EVENT","markTargetLoaded","event","target","__loaded","checkDone","parsedCount","importCount","allImports","imports","loadedImports","newImports","errorImports","loadedImport","e","push","errorLoadingImport","IMPORT_SELECTOR","Array","prototype","slice","call","filter","matches","imp","useNative","import","IMPORT_LINK_TYPE","document","createElement","hasShadowDOMPolyfill","ShadowDOMPolyfill","window","wrapIfNeeded","currentScriptDescriptor","get","script","currentScript","scripts","node","configurable","Object","defineProperty","ABS_URL_TEST","CSS_URL_REGEXP","CSS_IMPORT_REGEXP","style","linkUrl","textContent","cssText","r","replaceUrls","text","regexp","replace","m","pre","url","post","urlPath","href","URL","test","xhr","async","ok","request","status","load","next","nextContext","XMLHttpRequest","open","redirectedUrl","locationHeader","getResponseHeader","substr","location","origin","console","error","message","response","responseText","send","loadDocument","responseType","addNodes","nodes","require","addNode","elt","src","dedupe","fetch","tail","match","pieces","split","body","header","indexOf","atob","decodeURIComponent","setTimeout","receive","bind","err","resource","$p","p","importer","documents","loadNode","importLoader","loadSubtree","parent","loaded","__resource","__error","getAttribute","undefined","setAttribute","display","innerHTML","s$","o","__baseURI","__parentImportContent","assetpath","importsSelectors","__importLink","bootDocument","__doc","loadedAll","_flatten","c","__pendingResources","parentNode","replaceChild","_fireEvents","observe","head","__firstImport","from","styles","map","appendChild","eventType","all","then","dispatchEvent","CustomEvent","__importObserver","MutationObserver","mxns","forEach","addedNodes","nodeType","Node","ELEMENT_NODE","childList","subtree","isIE","navigator","userAgent","handleImport","rel","detail","ready","readyTime","getTime","Date","evt","createEvent","initCustomEvent","baseURI","baseURIDescriptor","querySelector","bootstrap","attachEvent","HTMLImports"],"mappings":"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","file":"html-imports.min.js","sourcesContent":["/**\r\n * @license\r\n * Copyright (c) 2016 The Polymer Project Authors. All rights reserved.\r\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\r\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\r\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\r\n * Code distributed by Google as part of the polymer project is also\r\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\r\n */\r\n(function(scope) {\r\n\r\n/********************* base setup *********************/\r\nvar IMPORT_LINK_TYPE = 'import';\r\nvar IMPORT_SELECTOR = 'link[rel=' + IMPORT_LINK_TYPE + ']';\r\nvar useNative = Boolean(IMPORT_LINK_TYPE in document.createElement('link'));\r\nvar flags = {bust: false, log: false};\r\n\r\n/**\r\n  Support `currentScript` on all browsers as `document._currentScript.`\r\n\r\n  NOTE: We cannot polyfill `document.currentScript` because it's not possible\r\n  both to override and maintain the ability to capture the native value.\r\n  Therefore we choose to expose `_currentScript` both when native imports\r\n  and the polyfill are in use.\r\n*/\r\n// NOTE: ShadowDOMPolyfill intrusion.\r\nvar hasShadowDOMPolyfill = Boolean(window.ShadowDOMPolyfill);\r\nvar wrap = function(node) {\r\n  return hasShadowDOMPolyfill ? window.ShadowDOMPolyfill.wrapIfNeeded(node) : node;\r\n};\r\nvar rootDocument = wrap(document);\r\n\r\nvar currentScriptDescriptor = {\r\n  get: function() {\r\n    var script = scope.currentScript || document.currentScript ||\r\n        // NOTE: only works when called in synchronously executing code.\r\n        // readyState should check if `loading` but IE10 is\r\n        // interactive when scripts run so we cheat.\r\n        (document.readyState !== 'complete' ?\r\n        document.scripts[document.scripts.length - 1] : null);\r\n    return wrap(script);\r\n  },\r\n  configurable: true\r\n};\r\n\r\nObject.defineProperty(document, '_currentScript', currentScriptDescriptor);\r\nObject.defineProperty(rootDocument, '_currentScript', currentScriptDescriptor);\r\n\r\n/********************* path fixup *********************/\r\nvar ABS_URL_TEST = /(^\\/)|(^#)|(^[\\w-\\d]*:)/;\r\nvar CSS_URL_REGEXP = /(url\\()([^)]*)(\\))/g;\r\nvar CSS_IMPORT_REGEXP = /(@import[\\s]+(?!url\\())([^;]*)(;)/g;\r\n\r\n// path fixup: style elements in imports must be made relative to the main\r\n// document. We fixup url's in url() and @import.\r\nvar path = {\r\n\r\n  resolveUrlsInStyle: function(style, linkUrl) {\r\n    style.textContent = this.resolveUrlsInCssText(style.textContent, linkUrl);\r\n  },\r\n\r\n  resolveUrlsInCssText: function(cssText, linkUrl) {\r\n    var r = this.replaceUrls(cssText, linkUrl, CSS_URL_REGEXP);\r\n    r = this.replaceUrls(r, linkUrl, CSS_IMPORT_REGEXP);\r\n    return r;\r\n  },\r\n\r\n  replaceUrls: function(text, linkUrl, regexp) {\r\n    return text.replace(regexp, function(m, pre, url, post) {\r\n      var urlPath = url.replace(/[\"']/g, '');\r\n      if (linkUrl) {\r\n        urlPath = (new URL(urlPath, linkUrl)).href;\r\n      }\r\n      return pre + '\\'' + urlPath + '\\'' + post;\r\n    });\r\n  },\r\n\r\n  replaceAttrUrl: function(text, linkUrl) {\r\n    if (text && ABS_URL_TEST.test(text)) {\r\n      return text;\r\n    } else {\r\n      return new URL(text, linkUrl).href;\r\n    }\r\n  }\r\n\r\n};\r\n\r\n/********************* xhr processor *********************/\r\nvar xhr = {\r\n  async: true,\r\n\r\n  ok: function(request) {\r\n    return (request.status >= 200 && request.status < 300)\r\n        || (request.status === 304)\r\n        || (request.status === 0);\r\n  },\r\n\r\n  load: function(url, next, nextContext) {\r\n    var request = new XMLHttpRequest();\r\n    if (flags.bust) {\r\n      url += '?' + Math.random();\r\n    }\r\n    request.open('GET', url, xhr.async);\r\n    request.addEventListener('readystatechange', function(e) {\r\n      if (request.readyState === 4) {\r\n        // Servers redirecting an import can add a Location header to help us\r\n        // polyfill correctly.\r\n        var redirectedUrl = null;\r\n        try {\r\n          var locationHeader = request.getResponseHeader(\"Location\");\r\n          if (locationHeader) {\r\n            redirectedUrl = (locationHeader.substr( 0, 1 ) === \"/\")\r\n              ? location.origin + locationHeader  // Location is a relative path\r\n              : locationHeader;                   // Full path\r\n          }\r\n        } catch ( e ) {\r\n            console.error( e.message );\r\n        }\r\n        next.call(nextContext, !xhr.ok(request) && request,\r\n            request.response || request.responseText, redirectedUrl);\r\n      }\r\n    });\r\n    request.send();\r\n    return request;\r\n  },\r\n\r\n  loadDocument: function(url, next, nextContext) {\r\n    this.load(url, next, nextContext).responseType = 'document';\r\n  }\r\n\r\n};\r\n\r\n/********************* loader *********************/\r\n// This loader supports a dynamic list of urls\r\n// and an oncomplete callback that is called when the loader is done.\r\n// NOTE: The polyfill currently does *not* need this dynamism or the\r\n// onComplete concept. Because of this, the loader could be simplified\r\n// quite a bit.\r\nvar Loader = function(onLoad, onComplete) {\r\n  this.cache = {};\r\n  this.onload = onLoad;\r\n  this.oncomplete = onComplete;\r\n  this.inflight = 0;\r\n  this.pending = {};\r\n};\r\n\r\nLoader.prototype = {\r\n\r\n  addNodes: function(nodes) {\r\n    // number of transactions to complete\r\n    this.inflight += nodes.length;\r\n    // commence transactions\r\n    for (var i=0, l=nodes.length, n; (i<l) && (n=nodes[i]); i++) {\r\n      this.require(n);\r\n    }\r\n    // anything to do?\r\n    this.checkDone();\r\n  },\r\n\r\n  addNode: function(node) {\r\n    // number of transactions to complete\r\n    this.inflight++;\r\n    // commence transactions\r\n    this.require(node);\r\n    // anything to do?\r\n    this.checkDone();\r\n  },\r\n\r\n  require: function(elt) {\r\n    var url = elt.src || elt.href;\r\n    // deduplication\r\n    if (!this.dedupe(url, elt)) {\r\n      // fetch this resource\r\n      this.fetch(url, elt);\r\n    }\r\n  },\r\n\r\n  dedupe: function(url, elt) {\r\n    if (this.pending[url]) {\r\n      // add to list of nodes waiting for inUrl\r\n      this.pending[url].push(elt);\r\n      // don't need fetch\r\n      return true;\r\n    }\r\n    var resource;\r\n    if (this.cache[url]) {\r\n      this.onload(url, elt, this.cache[url]);\r\n      // finished this transaction\r\n      this.tail();\r\n      // don't need fetch\r\n      return true;\r\n    }\r\n    // first node waiting for inUrl\r\n    this.pending[url] = [elt];\r\n    // need fetch (not a dupe)\r\n    return false;\r\n  },\r\n\r\n  fetch: function(url, elt) {\r\n    flags.log && console.log('fetch', url, elt);\r\n    if (!url) {\r\n      setTimeout(this.receive.bind(this, url, elt, {\r\n        error: 'href must be specified'\r\n      }, null), 0);\r\n    } else if (url.match(/^data:/)) {\r\n      // Handle Data URI Scheme\r\n      var pieces = url.split(',');\r\n      var header = pieces[0];\r\n      var body = pieces[1];\r\n      if(header.indexOf(';base64') > -1) {\r\n        body = atob(body);\r\n      } else {\r\n        body = decodeURIComponent(body);\r\n      }\r\n      setTimeout(this.receive.bind(this, url, elt, null, body), 0);\r\n    } else {\r\n      xhr.load(url, this.receive.bind(this, url, elt));\r\n    }\r\n  },\r\n\r\n  receive: function(url, elt, err, resource, redirectedUrl) {\r\n    this.cache[url] = resource;\r\n    var $p = this.pending[url];\r\n    for (var i=0, l=$p.length, p; (i<l) && (p=$p[i]); i++) {\r\n      // If url was redirected, use the redirected location so paths are\r\n      // calculated relative to that.\r\n      this.onload(url, p, resource, err, redirectedUrl);\r\n      this.tail();\r\n    }\r\n    this.pending[url] = null;\r\n  },\r\n\r\n  tail: function() {\r\n    --this.inflight;\r\n    this.checkDone();\r\n  },\r\n\r\n  checkDone: function() {\r\n    if (!this.inflight) {\r\n      this.oncomplete();\r\n    }\r\n  }\r\n};\r\n\r\n/********************* importer *********************/\r\nvar importsSelectors = [\r\n    IMPORT_SELECTOR,\r\n    'link[rel=stylesheet]:not([type])',\r\n    'style:not([type])',\r\n    'script:not([type])',\r\n    'script[type=\"application/javascript\"]',\r\n    'script[type=\"text/javascript\"]'\r\n  ].join(',');\r\n\r\n// importer\r\n// highlander object to manage loading of imports\r\n// for any document, importer:\r\n// - loads any linked import documents (with deduping)\r\n// - whenever an import is loaded, prompts the parser to try to parse\r\n// - observes imported documents for new elements (these are handled via the\r\n// dynamic importer)\r\nvar importer = {\r\n\r\n  documents: {},\r\n\r\n  loadNode: function(node) {\r\n    importLoader.addNode(node);\r\n  },\r\n\r\n  // load all loadable elements within the parent element\r\n  loadSubtree: function(parent) {\r\n    var nodes = parent.querySelectorAll(IMPORT_SELECTOR);\r\n    // add these nodes to loader's queue\r\n    importLoader.addNodes(nodes);\r\n  },\r\n\r\n  loaded: function(url, elt, resource, err, redirectedUrl) {\r\n    flags.log && console.log('loaded', url, elt);\r\n    // store generic resource\r\n    // TODO(sorvell): fails for nodes inside <template>.content\r\n    // see https://code.google.com/p/chromium/issues/detail?id=249381.\r\n    elt.__resource = resource;\r\n    elt.__error = err;\r\n    if (isImportLink(elt)) {\r\n      var doc = this.documents[url];\r\n      // if we've never seen a document at this url\r\n      if (doc === undefined) {\r\n        // generate an HTMLDocument from data\r\n        doc = err ? null : makeDocument(resource, redirectedUrl || url);\r\n        if (doc) {\r\n          doc.__importLink = elt;\r\n          // note, we cannot use MO to detect parsed nodes because\r\n          // SD polyfill does not report these as mutations.\r\n          this.bootDocument(doc);\r\n        }\r\n        // cache document\r\n        this.documents[url] = doc;\r\n      }\r\n      // don't store import record until we're actually loaded\r\n      // store document resource\r\n      elt.__doc = doc;\r\n    }\r\n  },\r\n\r\n  bootDocument: function(doc) {\r\n    this.loadSubtree(doc);\r\n  },\r\n\r\n  loadedAll: function() {\r\n    this._flatten(document);\r\n    runScripts();\r\n    this._fireEvents(document);\r\n    this.observe(document.head);\r\n  },\r\n\r\n  _flatten: function(element) {\r\n    const n$ = element.querySelectorAll(IMPORT_SELECTOR);\r\n    for (let i = 0, l = n$.length, n; i < l && (n = n$[i]); i++) {\r\n      n.import = this.documents[n.href];\r\n      if (n.import && !n.import.__firstImport) {\r\n        n.import.__firstImport = n;\r\n        this._flatten(n.import);\r\n        if (!n.import.parentNode) {\r\n          // Get pending stylesheets, init the __pendingResources array.\r\n          var styles = n.import.querySelectorAll('link[rel=stylesheet][href]');\r\n          n.import.__pendingResources = Array.from(styles).map(getLoadingDonePromise);\r\n          n.appendChild(n.import);\r\n          if (document.contains(n.parentNode)) {\r\n            // TODO(sorvell): need to coordinate with observer in document.head.\r\n            //this.observe(n.import);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  _fireEvents: function(element) {\r\n    const n$ = element.querySelectorAll(IMPORT_SELECTOR);\r\n    for (let i = 0, l = n$.length, n; i < l && (n = n$[i]); i++) {\r\n      if (n.__loaded === undefined) {\r\n        n.__loaded = false;\r\n        const eventType = n.import ? 'load' : 'error';\r\n        flags.log && console.warn('fire', eventType, n.href);\r\n        Promise.all(n.import ? n.import.__pendingResources : []).then(() => {\r\n          n.__loaded = true;\r\n          n.dispatchEvent(new CustomEvent(eventType));\r\n        });\r\n      }\r\n    }\r\n  },\r\n\r\n  observe: function(element) {\r\n    if (element.__importObserver) {\r\n      return;\r\n    }\r\n    element.__importObserver = new MutationObserver(function (mxns) {\r\n      mxns.forEach(function(m) {\r\n        if (m.addedNodes) {\r\n          for (var i=0; i < m.addedNodes.length; i++) {\r\n            var p = m.addedNodes[i];\r\n            // TODO(sorvell): x-platform matches\r\n            if (p.nodeType === Node.ELEMENT_NODE &&\r\n                p.matches(IMPORT_SELECTOR)) {\r\n              importer.loadNode(p);\r\n            }\r\n          }\r\n        }\r\n      });\r\n    });\r\n    element.__importObserver.observe(element, {childList: true, subtree: true});\r\n  }\r\n\r\n};\r\n\r\n// loader singleton to handle loading imports\r\nvar importLoader = new Loader(importer.loaded.bind(importer),\r\n    importer.loadedAll.bind(importer));\r\n\r\nfunction isImportLink(elt) {\r\n  return isLinkRel(elt, IMPORT_LINK_TYPE);\r\n}\r\n\r\nfunction isLinkRel(elt, rel) {\r\n  return elt.localName === 'link' && elt.getAttribute('rel') === rel;\r\n}\r\n\r\nfunction hasBaseURIAccessor(doc) {\r\n  return !! Object.getOwnPropertyDescriptor(doc, 'baseURI');\r\n}\r\n\r\n/********************* vulcanize style inline processing  *********************/\r\nvar attrs = ['action', 'src', 'href', 'url', 'style'];\r\nfunction fixUrlAttributes(element, base) {\r\n  for (var i=0, l=attrs.length, a, at, v; (i<l) && (a=attrs[i]); i++) {\r\n    at = element.attributes[a];\r\n    v = at && at.value;\r\n    if (v && (v.search(/({{|\\[\\[)/) < 0)) {\r\n      at.value = (a === 'style') ?\r\n        path.resolveUrlsInCssText(v, base) :\r\n        path.replaceAttrUrl(v, base);\r\n    }\r\n  }\r\n}\r\n\r\nfunction fixUrlsInTemplate(template, base) {\r\n  var content = template.content;\r\n  var n$ = content.querySelectorAll('style, form[action], [src], [href], [url], [style]');\r\n  for (var i=0; i < n$.length; i++) {\r\n    var n = n$[i];\r\n    if (n.localName == 'style') {\r\n      path.resolveUrlsInStyle(n, base);\r\n    } else {\r\n      fixUrlAttributes(n, base);\r\n    }\r\n  }\r\n  fixUrlsInTemplates(content, base);\r\n}\r\n\r\nfunction fixUrlsInTemplates(element, base) {\r\n  var t$ = element.querySelectorAll('template');\r\n  for (var i=0; i < t$.length; i++) {\r\n    fixUrlsInTemplate(t$[i], base);\r\n  }\r\n}\r\n\r\nfunction fixUrls(element, base) {\r\n  var n$ = element.querySelectorAll(importsSelectors);\r\n  for (var i=0; i < n$.length; i++) {\r\n    var n = n$[i];\r\n    if (n.href) {\r\n      n.href = new URL(n.getAttribute('href'), base);\r\n    }\r\n    if (n.src) {\r\n      n.src = new URL(n.getAttribute('src'), base);\r\n    }\r\n    if (n.localName == 'style') {\r\n      path.resolveUrlsInStyle(n, base);\r\n    }\r\n  }\r\n  fixUrlsInTemplates(element, base);\r\n}\r\n\r\nfunction markScripts(element, url) {\r\n  var s$ = element.querySelectorAll('script');\r\n  for (var i=0; i < s$.length; i++) {\r\n    var o = s$[i];\r\n    o.__baseURI = url;\r\n    o.__parentImportContent = element;\r\n  }\r\n}\r\n\r\n// done for security reasons. TODO(valdrin) document\r\nfunction runScripts() {\r\n  var s$ = document.querySelectorAll('import-content script');\r\n  for (var i = 0; i < s$.length; i++) {\r\n    var o = s$[i];\r\n    var c = document.createElement('script');\r\n    if (o.textContent) {\r\n      c.textContent = o.textContent + '\\n//# sourceURL=' +\r\n        o.__baseURI + (s$.length > 1 ? i : '') + '.js';\r\n    }\r\n    if (o.src) {\r\n      var src = path.replaceAttrUrl(o.getAttribute('src'), o.__baseURI);\r\n      c.setAttribute('src', src);\r\n      o.__parentImportContent.__pendingResources.push(getLoadingDonePromise(c));\r\n    }\r\n    o.parentNode.replaceChild(c, o);\r\n  }\r\n}\r\n\r\nfunction getLoadingDonePromise(element) {\r\n  return new Promise(resolve => {\r\n    element.addEventListener('load', resolve);\r\n    element.addEventListener('error', resolve);\r\n  });\r\n}\r\n\r\nfunction fixDomModules(element, url) {\r\n  var s$ = element.querySelectorAll('dom-module');\r\n  for (var i=0; i < s$.length; i++) {\r\n    var o = s$[i];\r\n    var assetpath = o.getAttribute('assetpath') || '';\r\n    o.setAttribute('assetpath', path.replaceAttrUrl(assetpath, url));\r\n  }\r\n}\r\n\r\n\r\n\r\nfunction makeDocument(resource, url) {\r\n  // TODO(valdrin): better to use a disconnected document here so that\r\n  // elements don't upgrade until inserted into main document,\r\n  // however, this is blocked on https://bugs.webkit.org/show_bug.cgi?id=165617\r\n  // let doc = document.implementation.createHTMLDocument();\r\n  var content = document.createElement('import-content');\r\n  content.setAttribute('import-href', url);\r\n  content.style.display = 'none';\r\n  content.innerHTML = resource;\r\n  markScripts(content, url);\r\n  // TODO(sorvell): this is specific to users (Polymer) of the dom-module element.\r\n  fixDomModules(content, url);\r\n  fixUrls(content, url);\r\n  return content;\r\n}\r\n\r\n/**\r\n  Add support for the `HTMLImportsLoaded` event and the `HTMLImports.whenReady`\r\n  method. This api is necessary because unlike the native implementation,\r\n  script elements do not force imports to resolve. Instead, users should wrap\r\n  code in either an `HTMLImportsLoaded` handler or after load time in an\r\n  `HTMLImports.whenReady(callback)` call.\r\n\r\n  NOTE: This module also supports these apis under the native implementation.\r\n  Therefore, if this file is loaded, the same code can be used under both\r\n  the polyfill and native implementation.\r\n */\r\n\r\nvar isIE = /Trident/.test(navigator.userAgent);\r\n\r\n// call a callback when all HTMLImports in the document at call time\r\n// (or at least document ready) have loaded.\r\n// 1. ensure the document is in a ready state (has dom), then\r\n// 2. watch for loading of imports and call callback when done\r\nfunction whenReady(callback, doc) {\r\n  doc = doc || rootDocument;\r\n  // if document is loading, wait and try again\r\n  whenDocumentReady(function() {\r\n    watchImportsLoad(callback, doc);\r\n  }, doc);\r\n}\r\n\r\n// call the callback when the document is in a ready state (has dom)\r\nvar requiredReadyState = isIE ? 'complete' : 'interactive';\r\nvar READY_EVENT = 'readystatechange';\r\nfunction isDocumentReady(doc) {\r\n  return (doc.readyState === 'complete' ||\r\n      doc.readyState === requiredReadyState);\r\n}\r\n\r\n// call <callback> when we ensure the document is in a ready state\r\nfunction whenDocumentReady(callback, doc) {\r\n  if (!isDocumentReady(doc)) {\r\n    var checkReady = function() {\r\n      if (doc.readyState === 'complete' ||\r\n          doc.readyState === requiredReadyState) {\r\n        doc.removeEventListener(READY_EVENT, checkReady);\r\n        whenDocumentReady(callback, doc);\r\n      }\r\n    };\r\n    doc.addEventListener(READY_EVENT, checkReady);\r\n  } else if (callback) {\r\n    callback();\r\n  }\r\n}\r\n\r\nfunction markTargetLoaded(event) {\r\n  event.target.__loaded = true;\r\n}\r\n\r\n// call <callback> when we ensure all imports have loaded\r\nfunction watchImportsLoad(callback, doc) {\r\n  var imports = doc.querySelectorAll(IMPORT_SELECTOR);\r\n  // only non-nested imports\r\n  imports = Array.prototype.slice.call(imports).filter(function(n) {\r\n    return !n.matches('import-content ' + IMPORT_SELECTOR);\r\n  });\r\n  var parsedCount = 0, importCount = imports.length, newImports = [], errorImports = [];\r\n  function checkDone() {\r\n    if (parsedCount == importCount && callback) {\r\n      callback({\r\n        allImports: imports,\r\n        loadedImports: newImports,\r\n        errorImports: errorImports\r\n      });\r\n    }\r\n  }\r\n  function loadedImport(e) {\r\n    markTargetLoaded(e);\r\n    newImports.push(this);\r\n    parsedCount++;\r\n    checkDone();\r\n  }\r\n  function errorLoadingImport(e) {\r\n    errorImports.push(this);\r\n    parsedCount++;\r\n    checkDone();\r\n  }\r\n  if (importCount) {\r\n    for (var i=0, imp; i<importCount && (imp=imports[i]); i++) {\r\n      if (isImportLoaded(imp)) {\r\n        if (imp.import) {\r\n          newImports.push(imp);\r\n        } else {\r\n          errorImports.push(imp);\r\n        }\r\n        parsedCount++;\r\n        checkDone();\r\n      } else {\r\n        imp.addEventListener('load', loadedImport);\r\n        imp.addEventListener('error', errorLoadingImport);\r\n      }\r\n    }\r\n  } else {\r\n    checkDone();\r\n  }\r\n}\r\n\r\nfunction isImportLoaded(link) {\r\n  return useNative ? link.__loaded ||\r\n      (link.import && link.import.readyState !== 'loading') :\r\n      link.__loaded;\r\n}\r\n\r\n// make `whenReady` work with native HTMLImports\r\nif (useNative) {\r\n  new MutationObserver(function(mxns) {\r\n    for (var i=0, l=mxns.length, m; (i < l) && (m=mxns[i]); i++) {\r\n      if (m.addedNodes) {\r\n        handleImports(m.addedNodes);\r\n      }\r\n    }\r\n  }).observe(document.head, {childList: true});\r\n\r\n  function handleImports(nodes) {\r\n    for (var i=0, l=nodes.length, n; (i<l) && (n=nodes[i]); i++) {\r\n      if (isImport(n)) {\r\n        handleImport(n);\r\n      }\r\n    }\r\n  }\r\n\r\n  function isImport(element) {\r\n    return element.localName === 'link' && element.rel === 'import';\r\n  }\r\n\r\n  function handleImport(element) {\r\n    var loaded = element.import;\r\n    if (loaded) {\r\n      markTargetLoaded({target: element});\r\n    } else {\r\n      element.addEventListener('load', markTargetLoaded);\r\n      element.addEventListener('error', markTargetLoaded);\r\n    }\r\n  }\r\n\r\n  // make sure to catch any imports that are in the process of loading\r\n  // when this script is run.\r\n  (function() {\r\n    if (document.readyState === 'loading') {\r\n      var imports = document.querySelectorAll(IMPORT_SELECTOR);\r\n      for (var i=0, l=imports.length, imp; (i<l) && (imp=imports[i]); i++) {\r\n        handleImport(imp);\r\n      }\r\n    }\r\n  })();\r\n\r\n}\r\n\r\n// Fire the 'HTMLImportsLoaded' event when imports in document at load time\r\n// have loaded. This event is required to simulate the script blocking\r\n// behavior of native imports. A main document script that needs to be sure\r\n// imports have loaded should wait for this event.\r\nwhenReady(function(detail) {\r\n  scope.ready = true;\r\n  scope.readyTime = new Date().getTime();\r\n  var evt = rootDocument.createEvent(\"CustomEvent\");\r\n  evt.initCustomEvent(\"HTMLImportsLoaded\", true, true, detail);\r\n  rootDocument.dispatchEvent(evt);\r\n});\r\n\r\n// Polyfill document.baseURI for browsers without it.\r\nif (!document.baseURI) {\r\n  var baseURIDescriptor = {\r\n    get: function() {\r\n      var base = document.querySelector('base');\r\n      return base ? base.href : window.location.href;\r\n    },\r\n    configurable: true\r\n  };\r\n\r\n  Object.defineProperty(document, 'baseURI', baseURIDescriptor);\r\n  Object.defineProperty(rootDocument, 'baseURI', baseURIDescriptor);\r\n}\r\n\r\nif (!useNative) {\r\n  function bootstrap() {\r\n    importer.bootDocument(document);\r\n  }\r\n\r\n  if (document.readyState === 'complete' ||\r\n      (document.readyState === 'interactive' && !window.attachEvent)) {\r\n    bootstrap();\r\n  } else {\r\n    document.addEventListener('DOMContentLoaded', bootstrap);\r\n  }\r\n}\r\n\r\n// exports\r\nscope.useNative = useNative;\r\nscope.whenReady = whenReady;\r\n\r\n})(window.HTMLImports = (window.HTMLImports || {}));\r\n"]}